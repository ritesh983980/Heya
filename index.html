<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Attendance Calendar with Notes</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #4361ee;
      --color-secondary: #3f37c9;
      --color-present: #2ecc71;
      --color-absent: #e74c3c;
      --color-holiday: #54acbf;
      --color-overtime: #f39c12;
      --color-clear: #bdc3c7;
      --color-half-day: #8e44ad; /* New: Half Day color */
      --color-leave: #34495e;    /* New: Leave color */
      --color-sunday: #e2ceb1;
      --color-text-dark: #2b2d42;
      --color-text-light: #ffffff;
      --color-bg: #f8f9fa;
      --color-card: #ffffff;
      --shadow-default: 0 4px 12px rgba(0,0,0,0.08);
      --shadow-active: 0 6px 16px rgba(0,0,0,0.12);
      --border-radius: 16px;
      --header-height: 60px;
      --footer-height: 80px;
      --safe-area-top: env(safe-area-inset-top, 0px);
      --safe-area-bottom: env(safe-area-inset-bottom, 0px);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #e0eafc, #cfdef3);
      color: var(--color-text-dark);
      min-height: 100vh;
      padding-top: var(--safe-area-top);
      padding-bottom: var(--safe-area-bottom);
      display: flex;
      flex-direction: column;
    }

    /* Fixed header */
    .top-bar {
      display: flex;
      align-items: center;
      padding: 0 20px;
      background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
      height: var(--header-height);
      box-shadow: var(--shadow-default);
      position: fixed;
      top: var(--safe-area-top);
      left: 0;
      right: 0;
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      font-size: 24px;
      color: white;
      background: rgba(255, 255, 255, 0.2);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .title {
      font-weight: 700;
      font-size: 1.25rem;
      color: white;
      letter-spacing: -0.5px;
    }

    .menu-bar {
      font-size: 1.8rem;
      cursor: pointer;
      color: white;
      margin-left: auto;
    }

    /* Main content area */
    .app-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: calc(var(--header-height) + 15px) 15px calc(var(--footer-height) + 15px);
      overflow-y: auto;
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }

    /* Calendar container */
    .calendar-container {
      background: var(--color-card);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
      margin-bottom: 20px;
      position: relative;
      z-index: 1;
    }

    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .btn-nav-month {
      background: rgba(67, 97, 238, 0.1);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1.8rem;
      cursor: pointer;
      color: var(--color-primary);
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-nav-month:hover {
      background: rgba(67, 97, 238, 0.2);
      transform: scale(1.05);
    }

    .month-year-display {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 1.3rem;
      color: var(--color-text-dark);
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
      flex: 1;
    }

    .weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--color-primary);
      font-size: 0.9rem;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 3px;
    }

    .day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      cursor: pointer;
      position: relative;
      background: var(--color-bg);
      font-weight: 400;
      height: 47px;
      color: var(--color-text-dark);
      transition: all 0.2s ease;
      font-size: 1.rem;
      border: 2px solid transparent;
      min-width: 35px;
      min-height: 35px;
    }

    .day:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-active);
    }

    .day.sunday {
      background: rgba(226, 206, 177, 0.3);
      color: #c44512;
    }

    /* Empty day styles */
    .day.empty-day {
      background-color: transparent;
      cursor: default;
      border: none;
    }

    .day.selected {
      border: 2px solid var(--color-primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
      transform: scale(1.05);
      z-index: 2;
    }

    .day.present { background-color: var(--color-present); color: white; }
    .day.absent { background-color: var(--color-absent); color: white; }
    .day.holiday { background-color: var(--color-holiday); color: white; }
    .day.half-day { background-color: var(--color-half-day); color: white; }
    .day.leave { background-color: var(--color-leave); color: white; }

    .day.current-day::after {
      content: '';
      position: absolute;
      bottom: 2px;
      left: 50%;
      transform: translateX(-50%);
      width: 40%;
      height: 2px;
      background-color: var(--color-primary);
      border-radius: 2px;
    }

    .overtime-badge {
      position: absolute;
      bottom: 1px;
      right: 1px;
      font-size: 0.79rem;
      background: var(--color-overtime);
      color: white;
      border-radius: 50%;
      width: 17px;
      height: 17px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .note-indicator {
      position: absolute;
      top: 1px;
      right: 28px;
      font-size: 0.6rem;
      background: var(--color-primary);
      color: white;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .action-button-wrapper {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 10px;
      max-width: 400px;
      margin: 0 auto;
    }

    .btn-action {
      flex: 1 1 calc(25% - 10px);
      padding: 8px;
      font-size: 12px;
      border: none;
      border-radius: 12px;
      color: white;
      font-weight: 600;
      text-align: center;
    }

    .button {
      background-color: #2196F3;
      color: white;
      transition: 0.3s;
    }

    .button {
      border: 2px solid transparent;
      transition: 0.3s ease;
    }

    .button:hover {
      border: 2px solid white;
    }

    .button {
      transition: all 0.3s ease;
    }

    .button:hover {
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
      transform: translateY(-3px);
      background-image: linear-gradient(135deg, #ff6ec4 0%, #7873f5 100%);
      color: white;
    }

    .btn-present { background: linear-gradient(135deg, #2ecc71, #27ae60); }
    .btn-absent { background: linear-gradient(135deg, #e74c3c, #c0392b); }
    .btn-holiday { background: linear-gradient(135deg, #3498db, #2980b9); }
    .btn-clear { background: linear-gradient(135deg, #7f8c8d, #6c7a7d); }
    .btn-note { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
    .btn-overtime { background: linear-gradient(135deg, #f39c12, #e67e22); }
    .btn-half-day { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
    .btn-leave { background: linear-gradient(135deg, #34495e, #2c3e50); }



 .btn-month-summary {
      display: block;
      margin: 0 auto;
      padding: 15px 25px;
      background: linear-gradient(135deg, #4361ee, #3a0ca3);
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-default);
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 0.9rem;
      width: 100%;
      max-width: 300px;
      margin-top: 20px;
      margin-bottom: 20px;
    }

    .btn-month-summary:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-active);
    }

    /* Day details panel */
    .day-details {
      background: var(--color-card);
      border-radius: var(--border-radius);
      padding: 20px;
      margin: 20px auto;
      box-shadow: var(--shadow-default);
      width: 100%;
      max-width: 500px;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 200;
      display: none;
    }

    .day-details.active {
      display: block;
      animation: slideIn 0.4s ease-out;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translate(-50%, -40%); }
      to { opacity: 1; transform: translate(-50%, -50%); }
    }

    .day-details-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .day-details-title {
      font-weight: 700;
      font-size: 1.3rem;
      color: var(--color-primary);
    }

    .day-details-content {
      margin-top: 15px;
    }

    .day-note {
      width: 100%;
      min-height: 120px;
      padding: 15px;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      resize: vertical;
      font-family: inherit;
      font-size: 1rem;
      transition: border 0.3s ease;
    }

    .day-note:focus {
      border-color: var(--color-primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    .btn-save-note {
      margin-top: 15px;
      padding: 12px 25px;
      background: linear-gradient(135deg, #4361ee, #3a0ca3);
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .btn-save-note:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-default);
    }

    /* Overlay */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 150;
      display: none;
    }

    .overlay.active {
      display: block;
    }

    /* Overtime Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 200;
      display: none;
    }

    .modal-overlay.active {
      display: flex;
    }

    .overtime-modal {
      background: white;
      padding: 25px;
      border-radius: 20px;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-weight: 700;
      font-size: 1.4rem;
      color: var(--color-primary);
    }

    .close-modal {
      background: #f5f5f5;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      transition: all 0.2s ease;
    }

    .close-modal:hover {
      background: #eaeaea;
      transform: rotate(90deg);
    }

    .overtime-input {
      width: 100%;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      margin-bottom: 20px;
      font-size: 1.1rem;
      text-align: center;
      transition: border 0.3s ease;
    }

    .overtime-input:focus {
      border-color: var(--color-primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    .modal-actions {
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    .btn-modal {
      padding: 12px 25px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      min-width: 100px;
    }

    .btn-cancel {
      background: #f0f0f0;
      color: #666;
    }

    .btn-cancel:hover {
      background: #e0e0e0;
    }

    .btn-save {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
    }

    .btn-save:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-default);
    }

    /* Status indicators */
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 5px;
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
      .calendar-container {
        padding: 15px;
      }

      .action-button-wrapper {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        padding: 0 10px;
      }

      .btn-action {
        min-width: unset;
        font-size: 0.75rem;
        padding: 10px 0;
      }

      .btn-action i {
        font-size: 1rem;
      }

      .month-year-display {
        font-size: 1.2rem;
      }
    }
    /* Animation for day cells */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .day.updated {
      animation: pulse 0.5s ease;
    }

    /* Side Menu Styles */
    .side-menu {
      position: fixed;
      top: 0;
      right: -250px;
      width: 250px;
      height: 100%;
      background-color: var(--color-secondary);
      box-shadow: -4px 0 15px rgba(0,0,0,0.2);
      transition: right 0.3s ease-in-out;
      z-index: 250;
      padding-top: var(--header-height);
      color: white;
    }

    .side-menu.active {
      right: 0;
    }

    .side-menu ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .side-menu li a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px 20px;
      text-decoration: none;
      color: white;
      font-size: 1.1rem;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      transition: background-color 0.2s ease;
    }

    .side-menu li a:hover {
      background-color: rgba(255,255,255,0.1);
    }

    .overlay-menu {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 240;
      display: none;
    }

    .overlay-menu.active {
      display: block;
    }

    /* Sub-Screen Common Styles */
    .screen-common {
      flex: 1;
      display: none; /* Hidden by default */
      flex-direction: column;
      padding: calc(var(--header-height) + 15px) 15px calc(var(--footer-height) + 15px);
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #e0eafc, #cfdef3);
      z-index: 90;
      overflow-y: auto;
    }

    .screen-common.active {
      display: flex;
    }

    .screen-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .screen-header h2 {
      flex-grow: 1;
      font-weight: 700;
      font-size: 1.5rem;
      color: var(--color-primary);
      text-align: center;
    }

    .btn-back {
      background: var(--color-primary);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .btn-back:hover {
      background: var(--color-secondary);
      transform: scale(1.05);
    }



 /* Holiday Screen Styles */
    .holidays-list {
      background: var(--color-card);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
    }

    .holiday-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .holiday-item:last-child {
      border-bottom: none;
    }

    .holiday-name {
      font-weight: 600;
      color: var(--color-text-dark);
      font-size: 1rem;
      flex-grow: 1;
    }

    .holiday-date {
      font-weight: 400;
      color: #666;
      font-size: 0.9rem;
      text-align: right;
    }

    /* Birthday Reminder Screen Styles */
    .birthday-form-card {
      background: var(--color-card);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
      margin-bottom: 20px;
    }

    .birthday-form-card input,
    .birthday-form-card select {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      color: var(--color-text-dark);
      transition: border-color 0.2s ease;
    }

    .birthday-form-card input:focus,
    .birthday-form-card select:focus {
      border-color: var(--color-primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    .birthday-form-card button {
      width: 100%;
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--color-secondary), var(--color-primary));
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .birthday-form-card button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-default);
    }

    .birthdays-list-container {
      background: var(--color-card);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
    }

    .birthday-list-item {
      background: #f8e8f8;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      display: flex;
      flex-direction: column;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .birthday-list-item:last-child {
      margin-bottom: 0;
    }

    .birthday-list-item strong {
      color: var(--color-text-dark);
      font-size: 1.1rem;
      margin-bottom: 5px;
    }

    .birthday-list-item span {
      color: #555;
    }

    .birthday-list-item i {
      margin-right: 8px;
      color: var(--color-secondary);
    }

    .delete-birthday-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      color: #e74c3c;
      font-size: 1.2rem;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s ease;
    }

    .delete-birthday-btn:hover {
      opacity: 1;
    }

    .birthday-icon {
      font-size: 1.8rem;
      color: var(--color-primary);
      margin-right: 10px;
    }

    /* Settings Screen Styles */
    .settings-screen {
      display: none;
    }

    .settings-list {
      background: var(--color-card);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
      overflow: hidden;
    }

    .settings-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .settings-item:last-child {
      border-bottom: none;
    }

    .settings-item:hover {
      background-color: #f9f9f9;
    }

    .settings-item i {
      font-size: 1.3rem;
      color: var(--color-primary);
      margin-right: 15px;
      width: 30px;
      text-align: center;
    }

    .settings-item-text {
      flex-grow: 1;
      font-size: 1.1rem;
      color: var(--color-text-dark);
      font-weight: 500;
    }

    .settings-item-action {
      color: #999;
      font-size: 1.2rem;
    }

    /* Toggle Switch */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 28px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      -webkit-transition: .4s;
      transition: .4s;
      border-radius: 28px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      -webkit-transition: .4s;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--color-primary);
    }

    input:focus + .slider {
      box-shadow: 0 0 1px var(--color-primary);
    }

    input:checked + .slider:before {
      -webkit-transform: translateX(22px);
      -ms-transform: translateX(22px);
      transform: translateX(22px);
    }

    .settings-section-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--color-primary);
      margin-top: 25px;
      margin-bottom: 15px;
      padding-left: 5px;
    }

    /* My Profile Screen Styles */
    .profile-screen {
      display: none; /* Hidden by default */
      align-items: center;
      justify-content: center;
      padding-top: calc(var(--header-height) + 20px); /* Add padding for header */
    }

    .profile-content {
      background: var(--color-card);
      padding: 30px 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
      width: 100%;
      max-width: 400px;
      text-align: center;
      margin-bottom: 20px; /* Space from bottom actions */
    }

    .profile-icon-container {
      width: 100px;
      height: 100px;
      background-color: var(--color-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 25px;
      font-size: 4rem;
      font-weight: 700;
      color: white;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-transform: uppercase;
    }

    .profile-input-group {
      margin-bottom: 20px;
      text-align: left;
    }

    .profile-input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--color-text-dark);
      font-size: 0.95rem;
    }

    .profile-input-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 1rem;
      font-family: inherit;
      color: var(--color-text-dark);
      transition: border-color 0.2s ease;
    }

    .profile-input-group input:focus {
      border-color: var(--color-primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }

    .social-media-section {
      margin-top: 30px;
      margin-bottom: 30px;
    }

    .social-media-section p {
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 15px;
      font-size: 1.1rem;
    }

    .social-icons {
      display: flex;
      justify-content: center;
      gap: 20px;
    }

    .social-icon-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--color-primary);
      color: white;
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }

    .social-icon-btn.facebook { background: #3b5998; }
    .social-icon-btn.instagram { background: #E1306C; }
    .social-icon-btn.youtube { background: #FF0000; }

    .social-icon-btn:hover {
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 6px 15px rgba(0,0,0,0.25);
    }

    .profile-actions {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }

    .btn-profile-action {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      max-width: 150px;
    }

    .btn-profile-action.save {
      background: linear-gradient(135deg, var(--color-secondary), var(--color-primary));
      color: white;
    }

    .btn-profile-action.save:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-default);
    }

    .btn-profile-action.close {
      background: #e0e0e0;
      color: #555;
    }

    .btn-profile-action.close:hover {
      background: #d0d0d0;
    }

    /* Calendar Activities Screen Styles */
    .calendar-activities-screen {
      display: none;
    }

    .calendar-form-card {
      background: var(--color-card);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
      margin-bottom: 20px;
    }

    .calendar-form-card h3 {
      font-size: 1.2rem;
      color: var(--color-primary);
      margin-bottom: 15px;
    }

    .calendar-form-card input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      color: var(--color-text-dark);
      transition: border-color 0.2s ease;
    }

    .calendar-form-card input:focus {
      border-color: var(--color-primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
    }



.calendar-form-card button {
      width: 100%;
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--color-secondary), var(--color-primary));
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .calendar-form-card button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-default);
    }

    .calendars-list-container {
      background: var(--color-card);
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-default);
    }

    .calendars-list-container h3 {
      font-size: 1.2rem;
      color: var(--color-primary);
      margin-bottom: 15px;
    }

    .calendar-list-item {
      display: flex;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .calendar-list-item:last-child {
      border-bottom: none;
    }

    .calendar-list-item .calendar-name {
      font-weight: 600;
      color: var(--color-text-dark);
      font-size: 1rem;
      flex-grow: 1;
      display: flex;
      align-items: center;
    }

    .calendar-list-item .calendar-name i {
      margin-right: 10px;
      color: var(--color-primary);
    }

    .calendar-list-item .calendar-actions {
      display: flex;
      gap: 8px;
    }

    .calendar-list-item .calendar-actions button {
      background: none;
      border: none;
      font-size: 1.1rem;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s ease, color 0.2s ease;
      padding: 5px; /* Added padding for easier clicking */
      border-radius: 50%;
    }

    .calendar-list-item .calendar-actions button:hover {
      opacity: 1;
    }

    .calendar-list-item .calendar-actions .btn-switch {
      color: var(--color-present);
    }
    .calendar-list-item .calendar-actions .btn-edit {
      color: var(--color-overtime);
    }
    .calendar-list-item .calendar-actions .btn-delete {
      color: var(--color-absent);
    }

    .calendar-list-item.active-calendar .calendar-name {
      color: var(--color-secondary);
      font-weight: 700;
    }
    .calendar-list-item.active-calendar .calendar-name i {
        color: var(--color-secondary);
    }
    .calendar-list-item.active-calendar .btn-switch {
        pointer-events: none; /* Disable switch button for active calendar */
        opacity: 0.3;
    }
    .calendar-list-item.active-calendar .btn-delete {
        pointer-events: none; /* Disable delete for active calendar */
        opacity: 0.3;
    }
  </style>
</head>
<body>
  <!-- Side menu for navigation -->
  <nav class="side-menu" id="sideMenu">
    <ul>
      <li><a href="#" id="myProfileBtn"><i class="fas fa-user"></i> My Profile</a></li>
      <li><a href="#" id="calendarActivitiesBtn"><i class="fas fa-plus-circle"></i> Calendar Activities</a></li>
      <li><a href="#" id="holidaysFestivalsBtn"><i class="fas fa-umbrella-beach"></i> Holidays / Festivals</a></li>
      <li><a href="#" id="birthdayReminderBtn"><i class="fas fa-birthday-cake"></i> Birthday Reminder</a></li>
      <li><a href="#" id="settingsBtn"><i class="fas fa-cog"></i> Settings</a></li>
      <li><a href="feedback.html"><i class="fas fa-comment-dots"></i> Send Feedback</a></li>
    </ul>
  </nav>
  <!-- Overlay for side menu -->
  <div class="overlay-menu" id="overlayMenu"></div>

  <!-- Top bar of the application -->
  <header class="top-bar">
    <div class="logo">
      <div class="logo-icon">
        <i class="fas fa-calendar-alt"></i>
      </div>
      <h1 class="title">Attendance Calendar</h1> <!-- Title of the application -->
    </div>
    <div class="menu-bar" id="menuToggle">
      <i class="fas fa-bars"></i>
    </div>
  </header>

  <!-- Main application container -->
  <main class="app-container" id="appContainer">
    <!-- Calendar display section -->
    <section class="calendar-container" id="calendarContainer">
      <div class="calendar-header">
        <button class="btn-nav-month" id="prevMonthBtn">
          <i class="fas fa-chevron-left"></i>
        </button>
        <h2 class="month-year-display" id="monthYearDisplay">May 2023</h2>
        <button class="btn-nav-month" id="nextMonthBtn">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <div class="weekdays">
        <span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span>
        <span>Thu</span><span>Fri</span><span>Sat</span>
      </div>

      <div class="calendar-grid" id="calendarGrid">
      </div>
    </section>

    <!-- Button to view monthly summary -->
    <button class="btn-month-summary" id="monthSummaryBtn">
      <i class="fas fa-chart-pie"></i> View Monthly Summary
    </button>

    <!-- Action buttons for marking attendance -->
    <div class="action-button-wrapper">
      <button class="btn-action btn-present" data-status="present">
        <i class="fas fa-check"></i>
        <span>Present</span>
      </button>
      <button class="btn-action btn-absent" data-status="absent">
        <i class="fas fa-times"></i>
        <span>Absent</span>
      </button>
      <button class="btn-action btn-holiday" data-status="holiday">
        <i class="fas fa-umbrella-beach"></i>
        <span>Holiday</span>
      </button>
      <button class="btn-action btn-half-day" data-status="half-day">
        <i class="fas fa-hourglass-half"></i>
        <span>Half Day</span>
      </button>
      <button class="btn-action btn-leave" data-status="leave">
        <i class="fas fa-plane-departure"></i>
        <span>Leave</span>
      </button>
      <button class="btn-action btn-clear" id="clearDayBtn">
        <i class="fas fa-eraser"></i>
        <span>Clear</span>
      </button>
      <button class="btn-action btn-note" id="noteBtn">
        <i class="fas fa-sticky-note"></i>
        <span>Note</span>
      </button>
      <button class="btn-action btn-overtime" id="overtimeBtn">
        <i class="fas fa-clock"></i>
        <span>Overtime</span>
      </button>
    </div>
  </main>

  <!-- Day details panel (hidden by default) -->
  <div class="day-details" id="dayDetails">
    <div class="day-details-header">
      <h3 class="day-details-title" id="dayDetailsTitle">Day Details</h3>
      <button class="close-modal" id="closeDayDetailsBtn">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="day-details-content">
      <textarea id="dayNote" class="day-note" placeholder="Add a note for this day..."></textarea>
      <button class="btn-save-note" id="saveDayNoteBtn">Save Note</button>
    </div>
  </div>

  <!-- Overtime input modal (hidden by default) -->
  <div class="modal-overlay" id="overtimeModal">
    <div class="overtime-modal">
      <div class="modal-header">
        <h3 class="modal-title">Overtime Hours</h3>
        <button class="close-modal" id="closeOvertimeModal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <input type="number" id="overtimeInput" class="overtime-input" placeholder="Enter hours" min="0" step="0.5">
      <div class="modal-actions">
        <button class="btn-modal btn-cancel" id="cancelOvertime">Cancel</button>
        <button class="btn-modal btn-save" id="saveOvertime">Save</button>
      </div>
    </div>
  </div>

  <!-- General overlay for modals/panels -->
  <div class="overlay" id="overlay"></div>

  <!-- Holiday Screen -->
  <section class="holiday-screen screen-common" id="holidayScreen">
    <div class="holiday-header screen-header">
      <button class="btn-back" id="backToCalendarFromHolidaysBtn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>2025 Holidays & Festivals</h2>
    </div>
    <div class="holidays-list" id="holidaysList">
    </div>
  </section>

  <!-- Birthday Reminder Screen -->
  <section class="birthday-screen screen-common" id="birthdayScreen">
    <div class="birthday-header screen-header">
      <button class="btn-back" id="backToCalendarFromBirthdaysBtn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2><i class="fas fa-birthday-cake birthday-icon"></i> Birthday Reminder</h2>
    </div>
    <div class="birthday-form-card">
      <input type="text" id="birthdayNameInput" placeholder="Enter Name" autocomplete="off">
      <input type="date" id="birthdayDateInput">
      <select id="birthdayRelationSelect">
        <option value="">Relation (optional)</option>
        <option value="Family">Family</option>
        <option value="Friend">Friend</option>
        <option value="Colleague">Colleague</option>
        <option value="Other">Other</option>
      </select>
      <button id="addBirthdayBtn">Add Birthday</button>
    </div>
    <div class="birthdays-list-container" id="birthdaysListContainer">
    </div>
  </section>

  <!-- Settings Screen -->
  <section class="settings-screen screen-common" id="settingsScreen">
    <div class="settings-header screen-header">
      <button class="btn-back" id="backToCalendarFromSettingsBtn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2><i class="fas fa-cog birthday-icon"></i> Settings</h2>
    </div>

    <div class="settings-section-title">Reminder</div>
    <div class="settings-list">
        <div class="settings-item">
            <i class="fas fa-bell"></i>
            <span class="settings-item-text">Daily Reminder</span>
            <label class="toggle-switch">
                <input type="checkbox" id="dailyReminderToggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="settings-section-title">General</div>
    <div class="settings-list">
        <div class="settings-item" id="appThemeBtn">
            <i class="fas fa-lightbulb"></i>
            <span class="settings-item-text">App Theme</span>
            <i class="fas fa-chevron-right settings-item-action"></i>
        </div>
        <div class="settings-item" id="shareAppBtn">
            <i class="fas fa-share-alt"></i>
            <span class="settings-item-text">Share App</span>
            <i class="fas fa-chevron-right settings-item-action"></i>
        </div>
    </div>

    <div class="settings-section-title">Others</div>
    <div class="settings-list">
        <a href="feedback.html" class="settings-item">
            <i class="fas fa-comment-dots"></i>
            <span class="settings-item-text">Feedback</span>
            <i class="fas fa-chevron-right settings-item-action"></i>
        </a>
        <div class="settings-item" id="privacyPolicyBtn">
            <i class="fas fa-shield-alt"></i>
            <span class="settings-item-text">Privacy Policy</span>
            <i class="fas fa-chevron-right settings-item-action"></i>
        </div>
        <div class="settings-item" id="aboutBtn">
            <i class="fas fa-info-circle"></i>
            <span class="settings-item-text">About</span>
            <i class="fas fa-chevron-right settings-item-action"></i>
        </div>
    </div>
  </section>

  <!-- My Profile Screen -->
  <section class="profile-screen screen-common" id="profileScreen">
    <div class="profile-header screen-header">
      <button class="btn-back" id="backToCalendarFromProfileBtn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>My Profile</h2>
    </div>
    <div class="profile-content">
      <div class="profile-icon-container" id="profileIconContainer">
        <span id="profileInitial">U</span>
      </div>
      <div class="profile-input-group">
        <label for="profileNameInput">Name</label>
        <input type="text" id="profileNameInput" placeholder="Enter your name" autocomplete="off">
      </div>
      <div class="profile-input-group">
        <label for="profileEmailInput">Email</label>
        <input type="email" id="profileEmailInput" placeholder="Enter your email" autocomplete="off">
      </div>

      <div class="social-media-section">
        <p>Join us on social media:</p>
        <div class="social-icons">
          <a href="https://www.facebook.com/yourprofile" target="_blank" class="social-icon-btn facebook" aria-label="Facebook">
            <i class="fab fa-facebook-f"></i>
          </a>
          <a href="https://www.instagram.com/yourprofile" target="_blank" class="social-icon-btn instagram" aria-label="Instagram">
            <i class="fab fa-instagram"></i>
          </a>
          <a href="https://www.youtube.com/yourchannel" target="_blank" class="social-icon-btn youtube" aria-label="YouTube">
            <i class="fab fa-youtube"></i>
          </a>
        </div>
      </div>

      <div class="profile-actions">
        <button class="btn-profile-action save" id="saveProfileBtn">Save</button>
        <button class="btn-profile-action close" id="closeProfileBtn">Close</button>
      </div>
    </div>
  </section>

  <!-- Calendar Activities Screen -->
  <section class="calendar-activities-screen screen-common" id="calendarActivitiesScreen">
    <div class="calendar-header screen-header">
      <button class="btn-back" id="backToCalendarFromCalendarActivitiesBtn">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2><i class="fas fa-calendar-check birthday-icon"></i> Calendar Activities</h2>
    </div>
    <div class="calendar-form-card">
      <h3>Add New Calendar</h3>
      <input type="text" id="newCalendarNameInput" placeholder="Enter new calendar name" autocomplete="off">
      <button id="addCalendarBtn">Add Calendar</button>
    </div>
    <div class="calendars-list-container">
      <h3>Your Calendars (<span id="activeCalendarNameSpan">Default</span> is active)</h3>
      <div id="calendarsList">
        <!-- Calendar list items will be rendered here -->
      </div>
    </div>
  </section>




  <script>
    class AttendanceCalendar {
      constructor() {
        // Initialize properties by getting elements from the DOM
        this.currentDate = new Date(); // Current date for calendar display
        this.selectedDays = []; // Array to store selected days
        this.selectedMonth = this.currentDate.getMonth(); // Selected month
        this.selectedYear = this.currentDate.getFullYear(); // Selected year

        // DOM elements
        this.calendarGrid = document.getElementById('calendarGrid');
        this.monthYearDisplay = document.getElementById('monthYearDisplay');
        this.prevMonthBtn = document.getElementById('prevMonthBtn');
        this.nextMonthBtn = document.getElementById('nextMonthBtn');
        this.monthSummaryBtn = document.getElementById('monthSummaryBtn');
        this.clearDayBtn = document.getElementById('clearDayBtn');
        this.noteBtn = document.getElementById('noteBtn');
        this.overtimeBtn = document.getElementById('overtimeBtn');

        this.dayDetails = document.getElementById('dayDetails');
        this.dayDetailsTitle = document.getElementById('dayDetailsTitle');
        this.dayNote = document.getElementById('dayNote');
        this.saveDayNoteBtn = document.getElementById('saveDayNoteBtn');
        this.closeDayDetailsBtn = document.getElementById('closeDayDetailsBtn');
        this.overlay = document.getElementById('overlay');

        this.overtimeModal = document.getElementById('overtimeModal');
        this.overtimeInput = document.getElementById('overtimeInput');
        this.closeOvertimeModal = document.getElementById('closeOvertimeModal');
        this.cancelOvertime = document.getElementById('cancelOvertime');
        this.saveOvertime = document.getElementById('saveOvertime');

        this.sideMenu = document.getElementById('sideMenu');
        this.menuToggle = document.getElementById('menuToggle');
        this.overlayMenu = document.getElementById('overlayMenu');
        this.appContainer = document.getElementById('appContainer');

        // Holiday Screen elements
        this.holidaysFestivalsBtn = document.getElementById('holidaysFestivalsBtn');
        this.holidayScreen = document.getElementById('holidayScreen');
        this.backToCalendarFromHolidaysBtn = document.getElementById('backToCalendarFromHolidaysBtn');
        this.holidaysList = document.getElementById('holidaysList');

        // Birthday Screen elements
        this.birthdayReminderBtn = document.getElementById('birthdayReminderBtn');
        this.birthdayScreen = document.getElementById('birthdayScreen');
        this.backToCalendarFromBirthdaysBtn = document.getElementById('backToCalendarFromBirthdaysBtn');
        this.birthdayNameInput = document.getElementById('birthdayNameInput');
        this.birthdayDateInput = document.getElementById('birthdayDateInput');
        this.birthdayRelationSelect = document.getElementById('birthdayRelationSelect');
        this.addBirthdayBtn = document.getElementById('addBirthdayBtn');
        this.birthdaysListContainer = document.getElementById('birthdaysListContainer');

        // Settings Screen elements
        this.settingsBtn = document.getElementById('settingsBtn');
        this.settingsScreen = document.getElementById('settingsScreen');
        this.backToCalendarFromSettingsBtn = document.getElementById('backToCalendarFromSettingsBtn');
        this.dailyReminderToggle = document.getElementById('dailyReminderToggle');
        this.appThemeBtn = document.getElementById('appThemeBtn');
        this.shareAppBtn = document.getElementById('shareAppBtn');
        this.privacyPolicyBtn = document.getElementById('privacyPolicyBtn');
        this.aboutBtn = document.getElementById('aboutBtn');

        // My Profile Screen elements
        this.myProfileBtn = document.getElementById('myProfileBtn');
        this.profileScreen = document.getElementById('profileScreen');
        this.backToCalendarFromProfileBtn = document.getElementById('backToCalendarFromProfileBtn');
        this.profileNameInput = document.getElementById('profileNameInput');
        this.profileEmailInput = document.getElementById('profileEmailInput');
        this.profileInitial = document.getElementById('profileInitial');
        this.saveProfileBtn = document.getElementById('saveProfileBtn');
        this.closeProfileBtn = document.getElementById('closeProfileBtn');

        // Calendar Activities Screen elements
        this.calendarActivitiesBtn = document.getElementById('calendarActivitiesBtn');
        this.calendarActivitiesScreen = document.getElementById('calendarActivitiesScreen');
        this.backToCalendarFromCalendarActivitiesBtn = document.getElementById('backToCalendarFromCalendarActivitiesBtn');
        this.newCalendarNameInput = document.getElementById('newCalendarNameInput');
        this.addCalendarBtn = document.getElementById('addCalendarBtn');
        this.calendarsList = document.getElementById('calendarsList');
        this.activeCalendarNameSpan = document.getElementById('activeCalendarNameSpan');

        // Top bar title element
        this.topBarTitle = document.querySelector('.top-bar .title');


        // Load data from localStorage or set initial values
        this.calendars = JSON.parse(localStorage.getItem("calendars")) || { "Default": {} };
        this.activeCalendar = localStorage.getItem("activeCalendar") || "Default";
        this.birthdays = JSON.parse(localStorage.getItem("birthdays")) || [];
        this.settings = JSON.parse(localStorage.getItem("settings")) || { dailyReminder: false };
        this.userProfile = JSON.parse(localStorage.getItem("userProfile")) || { name: "", email: "" };

        // Initialize the calendar and event listeners
        this.init();
      }

      init() {
        // Render the calendar
        this.setupCalendar();
        this.renderHolidays(); // Render holidays on initialization

        // Add event listeners
        this.prevMonthBtn.addEventListener('click', () => this.changeMonth(-1));
        this.nextMonthBtn.addEventListener('click', () => this.changeMonth(1));

        document.querySelectorAll('.btn-action[data-status]').forEach(button => {
          button.addEventListener('click', (event) => {
            const status = event.currentTarget.dataset.status;
            this.applyStatusToSelectedDays(status);
          });
        });

        this.clearDayBtn.addEventListener('click', () => this.clearSelectedDays());
        this.noteBtn.addEventListener('click', () => this.showDayDetails());
        this.overtimeBtn.addEventListener('click', () => this.showOvertimeModal());

        this.saveDayNoteBtn.addEventListener('click', () => this.saveDayNote());
        this.closeDayDetailsBtn.addEventListener('click', () => this.hideDayDetails());
        this.overlay.addEventListener('click', () => {
          this.hideDayDetails();
          this.hideOvertimeModal();
          this.toggleMenu(); // Close side menu if overlay is clicked
        });

        this.overlayMenu.addEventListener('click', () => this.toggleMenu());

        this.monthSummaryBtn.addEventListener('click', () => this.showMonthSummary());

        this.closeOvertimeModal.addEventListener('click', () => this.hideOvertimeModal());
        this.cancelOvertime.addEventListener('click', () => this.hideOvertimeModal());
        this.saveOvertime.addEventListener('click', () => this.saveOvertimeHours());

        if (this.menuToggle) {
          this.menuToggle.addEventListener('click', () => this.toggleMenu());
        }

        // Event Listeners for Holiday Screen
        if (this.holidaysFestivalsBtn) {
            this.holidaysFestivalsBtn.addEventListener('click', (e) => {
                e.preventDefault();
                this.toggleMenu();
                this.showScreen(this.holidayScreen);
            });
        }
        if (this.backToCalendarFromHolidaysBtn) {
            this.backToCalendarFromHolidaysBtn.addEventListener('click', () => this.hideScreen(this.holidayScreen));
        }

        // Event Listeners for Birthday Screen
        if (this.birthdayReminderBtn) {
            this.birthdayReminderBtn.addEventListener('click', (e) => {
                e.preventDefault();
                this.toggleMenu();
                this.showScreen(this.birthdayScreen);
                this.renderBirthdays();
            });
        }
        if (this.backToCalendarFromBirthdaysBtn) {
            this.backToCalendarFromBirthdaysBtn.addEventListener('click', () => this.hideScreen(this.birthdayScreen));
        }
        if (this.addBirthdayBtn) {
            this.addBirthdayBtn.addEventListener('click', () => this.addBirthday());
        }

        // Event Listeners for Settings Screen
        if (this.settingsBtn) {
          this.settingsBtn.addEventListener('click', (e) => {
            e.preventDefault();
            this.toggleMenu();
            this.showScreen(this.settingsScreen);
            this.loadSettings();
          });
        }
        if (this.backToCalendarFromSettingsBtn) {
          this.backToCalendarFromSettingsBtn.addEventListener('click', () => this.hideScreen(this.settingsScreen));
        }
        if (this.dailyReminderToggle) {
          this.dailyReminderToggle.addEventListener('change', () => this.toggleDailyReminder());
        }
        if (this.appThemeBtn) {
          this.appThemeBtn.addEventListener('click', () => alert("App Theme functionality coming soon!"));
        }
        if (this.shareAppBtn) {
          this.shareAppBtn.addEventListener('click', () => {
            if (navigator.share) {
              navigator.share({
                title: 'Attendance Calendar App',
                text: 'Check out this awesome Attendance Calendar App!',
                url: window.location.href,
              }).then(() => console.log('Shared successfully'))
                .catch((error) => console.error('Error sharing:', error));
            } else {
              alert("Share functionality not supported on this device/browser.");
            }
          });
        }
        if (this.privacyPolicyBtn) {
          this.privacyPolicyBtn.addEventListener('click', () => alert("Privacy Policy will be displayed here."));
        }
        if (this.aboutBtn) {
          this.aboutBtn.addEventListener('click', () => alert("Attendance Calendar v1.0. Developed by [Your Name/Company]."));
        }

        // Event Listeners for My Profile Screen
        if (this.myProfileBtn) {
          this.myProfileBtn.addEventListener('click', (e) => {
            e.preventDefault();
            this.toggleMenu();
            this.showScreen(this.profileScreen);
            this.loadProfile(); // Load data when opening the profile screen
          });
        }
        if (this.backToCalendarFromProfileBtn) {
          this.backToCalendarFromProfileBtn.addEventListener('click', () => this.hideScreen(this.profileScreen));
        }
        if (this.saveProfileBtn) {
          this.saveProfileBtn.addEventListener('click', () => this.saveProfile());
        }
        if (this.closeProfileBtn) {
          this.closeProfileBtn.addEventListener('click', () => this.hideScreen(this.profileScreen));
        }
        if (this.profileNameInput) {
            this.profileNameInput.addEventListener('input', () => this.updateProfileInitial());
        }

        // Event Listeners for Calendar Activities Screen
        if (this.calendarActivitiesBtn) {
            this.calendarActivitiesBtn.addEventListener('click', (e) => {
                e.preventDefault();
                this.toggleMenu();
                this.showScreen(this.calendarActivitiesScreen);
                this.renderCalendarList();
            });
        }
        if (this.backToCalendarFromCalendarActivitiesBtn) {
            this.backToCalendarFromCalendarActivitiesBtn.addEventListener('click', () => this.hideScreen(this.calendarActivitiesScreen));
        }
        if (this.addCalendarBtn) {
            this.addCalendarBtn.addEventListener('click', () => this.addCalendar());
        }
      }

      setupCalendar() {
        if (!this.calendars[this.activeCalendar]) {
          // This case should ideally not happen if 'Default' is guaranteed to exist,
          // but good for robustness if activeCalendar points to a deleted one.
          this.activeCalendar = "Default";
          this.saveData();
        }
        this.renderCalendar();
        this.updateTopBarTitle(); // Ensure top bar title is updated when calendar is setup
      }

      renderCalendar() {
        this.calendarGrid.innerHTML = '';
        this.monthYearDisplay.textContent = this.getFormattedMonthYear();

        const firstDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1).getDay();
        const daysInMonth = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0).getDate();

        const today = new Date();
        const isCurrentMonth = this.currentDate.getMonth() === today.getMonth() &&
                               this.currentDate.getFullYear() === today.getFullYear();

        // Add empty cells for days before the 1st of the month
        for (let i = 0; i < firstDay; i++) {
          const emptyCell = document.createElement('div');
          emptyCell.className = 'day empty-day';
          this.calendarGrid.appendChild(emptyCell);
        }




    // Populate calendar with days
        for (let day = 1; day <= daysInMonth; day++) {
          const dayCell = document.createElement('div');
          dayCell.className = 'day';
          dayCell.textContent = day;
          dayCell.dataset.day = day;

          // Mark Sundays
          if ((firstDay + day - 1) % 7 === 0) {
            dayCell.classList.add('sunday');
          }

          // Mark current day
          if (isCurrentMonth && day === today.getDate()) {
            dayCell.classList.add('current-day');
          }

          // Apply status, overtime, and note indicators
          const dayData = this.getDayData(day);
          if (dayData) {
            if (dayData.status) {
                dayCell.classList.add(dayData.status);
            }

            if (dayData.overtime) {
              const overtimeBadge = document.createElement('span');
              overtimeBadge.className = 'overtime-badge';
              overtimeBadge.textContent = dayData.overtime;
              dayCell.appendChild(overtimeBadge);
            }

            if (dayData.note) {
              const noteIndicator = document.createElement('span');
              noteIndicator.className = 'note-indicator';
              noteIndicator.innerHTML = '<i class="fas fa-pen"></i>';
              dayCell.appendChild(noteIndicator);
            }
          }

          // Apply selected class if day is selected
          if (this.selectedDays.includes(day)) {
            dayCell.classList.add('selected');
          }

          // Add click listener to each day cell
          dayCell.addEventListener('click', (event) => this.toggleDaySelection(dayCell, day, event));
          this.calendarGrid.appendChild(dayCell);
        }
      }

      // Toggles selection of a day
      toggleDaySelection(dayCell, day, event) {
        // Prevent selection if day details or overtime modal is active
        if (this.dayDetails.classList.contains('active') || this.overtimeModal.classList.contains('active')) {
            return;
        }

        if (this.selectedDays.includes(day)) {
          this.selectedDays = this.selectedDays.filter(d => d !== day);
          dayCell.classList.remove('selected');
        } else {
          this.selectedDays.push(day);
          dayCell.classList.add('selected');
        }

        this.selectedDays.sort((a, b) => a - b); // Keep selected days sorted

        this.selectedMonth = this.currentDate.getMonth();
        this.selectedYear = this.currentDate.getFullYear();

        // Hide modals if no days are selected
        if (this.selectedDays.length === 0) {
            this.hideDayDetails();
            this.hideOvertimeModal();
        }
      }

      // Gets data for a specific day from the active calendar
      getDayData(day) {
        const monthYearKey = `${this.currentDate.getMonth()}-${this.currentDate.getFullYear()}`;
        // Ensure active calendar and month key exist
        if (!this.calendars[this.activeCalendar]) {
          this.calendars[this.activeCalendar] = {};
        }
        if (!this.calendars[this.activeCalendar][monthYearKey]) {
            this.calendars[this.activeCalendar][monthYearKey] = {};
        }
        return this.calendars[this.activeCalendar][monthYearKey][day];
      }

      // Sets data for a specific day in the active calendar
      setDayData(day, data) {
        const monthYearKey = `${this.currentDate.getMonth()}-${this.currentDate.getFullYear()}`;
        // Ensure active calendar and month key exist
        if (!this.calendars[this.activeCalendar]) {
          this.calendars[this.activeCalendar] = {};
        }
        if (!this.calendars[this.activeCalendar][monthYearKey]) {
          this.calendars[this.activeCalendar][monthYearKey] = {};
        }

        // Clean up data: remove empty/undefined values
        if (!data || Object.keys(data).length === 0 || (Object.keys(data).length === 1 && data.status === undefined && data.overtime === undefined && data.note === undefined)) {
            delete this.calendars[this.activeCalendar][monthYearKey][day];
        } else {
            const existingData = this.calendars[this.activeCalendar][monthYearKey][day] || {};
            const updatedData = { ...existingData, ...data };

            for (const key in updatedData) {
                if (updatedData[key] === undefined || updatedData[key] === null || updatedData[key] === '') {
                    delete updatedData[key];
                }
            }

            if (Object.keys(updatedData).length === 0) {
                delete this.calendars[this.activeCalendar][monthYearKey][day];
            } else {
                this.calendars[this.activeCalendar][monthYearKey][day] = updatedData;
            }
        }

        this.saveData(); // Save data to localStorage

        // Add 'updated' class for a brief animation
        const dayCellElement = this.calendarGrid.querySelector(`.day[data-day="${day}"]`);
        if (dayCellElement && !dayCellElement.classList.contains('empty-day')) {
            dayCellElement.classList.add('updated');
            setTimeout(() => dayCellElement.classList.remove('updated'), 500);
        }
      }

      // Gets formatted month and year string
      getFormattedMonthYear() {
        return this.currentDate.toLocaleString('default', {
          month: 'long',
          year: 'numeric'
        });
      }

      // Saves all application data to localStorage
      saveData() {
        localStorage.setItem("calendars", JSON.stringify(this.calendars));
        localStorage.setItem("activeCalendar", this.activeCalendar);
        localStorage.setItem("birthdays", JSON.stringify(this.birthdays));
        localStorage.setItem("settings", JSON.stringify(this.settings));
        localStorage.setItem("userProfile", JSON.stringify(this.userProfile)); // Save profile data
      }

      // Applies a given status to all selected days
      applyStatusToSelectedDays(status) {
        if (this.selectedDays.length === 0) {
          alert("      !"); // Please select at least one day!
          return;
        }

        this.selectedDays.forEach(day => {
            const currentData = this.getDayData(day) || {};
            const newData = {
                status: status,
                overtime: currentData.overtime,
                note: currentData.note
            };
            this.setDayData(day, newData);
        });

        this.clearSelectionVisuals();
        this.selectedDays = [];
        this.renderCalendar();
      }

      // Clears status, overtime, and notes for selected days
      clearSelectedDays() {
        if (this.selectedDays.length === 0) {
          alert("      !"); // Please select at least one day!
          return;
        }

        this.selectedDays.forEach(day => {
            this.setDayData(day, {
                status: undefined,
                overtime: undefined,
                note: undefined
            });
        });
        this.clearSelectionVisuals();
        this.selectedDays = [];
        this.hideDayDetails();
        this.renderCalendar();
      }

      // Shows the overtime input modal
      showOvertimeModal() {
        if (this.selectedDays.length === 0) {
          alert("      !"); // Please select at least one day!
          return;
        }

        const firstSelectedDay = this.selectedDays[0];
        const currentData = this.getDayData(firstSelectedDay) || {};
        this.overtimeInput.value = currentData.overtime || '';
        this.overtimeModal.classList.add('active');
        this.overlay.classList.add('active');
        this.overtimeInput.focus();
        document.body.style.overflow = 'hidden'; // Prevent body scroll
      }

      // Hides the overtime input modal
      hideOvertimeModal() {
        this.overtimeModal.classList.remove('active');
        this.overlay.classList.remove('active');
        this.clearSelectionVisuals();
        this.selectedDays = [];
        this.renderCalendar();
        document.body.style.overflow = ''; // Restore body scroll
      }

      // Saves overtime hours for selected days
      saveOvertimeHours() {
        if (this.selectedDays.length === 0) {
          alert("     "); // No day selected.
          return;
        }

        const hours = parseFloat(this.overtimeInput.value);

        if (isNaN(hours) || hours < 0) {
          alert("      (0  )  "); // Please enter a valid number of hours (0 or more)
          return;
        }

        this.selectedDays.forEach(day => {
            const currentData = this.getDayData(day) || {};
            this.setDayData(day, {
                ...currentData,
                overtime: hours
            });
        });

        this.hideOvertimeModal();
      }

      // Shows the day details panel
      showDayDetails() {
        if (this.selectedDays.length === 0) {
          alert("      !"); // Please select at least one day!
          return;
        }

        const firstSelectedDay = this.selectedDays[0];
        const dateStr = new Date(this.selectedYear, this.selectedMonth, firstSelectedDay).toLocaleDateString('hi-IN', {day: 'numeric', month: 'long', year: 'numeric'});

        if (this.selectedDays.length > 1) {
            this.dayDetailsTitle.textContent = `${firstSelectedDay} - ${this.selectedDays[this.selectedDays.length - 1]} (${this.selectedDays.length} )`;
        } else {
            this.dayDetailsTitle.textContent = `: ${dateStr}`; // Details: [Date]
        }

        const dayData = this.getDayData(firstSelectedDay) || {};
        this.dayNote.value = dayData.note || '';

        this.dayDetails.classList.add('active');
        this.overlay.classList.add('active');
        document.body.style.overflow = 'hidden'; // Prevent body scroll
      }

      // Hides the day details panel
      hideDayDetails() {
        this.dayDetails.classList.remove('active');
        this.overlay.classList.remove('active');
        this.clearSelectionVisuals();
        this.selectedDays = [];
        this.renderCalendar();
        document.body.style.overflow = ''; // Restore body scroll
      }





 // Saves the note for selected days
      saveDayNote() {
        if (this.selectedDays.length === 0) {
            alert("     "); // No day selected.
            return;
        }

        const note = this.dayNote.value.trim();

        this.selectedDays.forEach(day => {
            const currentData = this.getDayData(day) || {};
            this.setDayData(day, {
                ...currentData,
                note: note || undefined // Set note to undefined if empty
            });
        });

        this.hideDayDetails();
      }

      // Changes the displayed month
      changeMonth(offset) {
        this.currentDate.setMonth(this.currentDate.getMonth() + offset);
        this.selectedDays = [];
        this.hideDayDetails();
        this.hideOvertimeModal();
        this.renderCalendar();
        this.updateCurrentDayHighlight();
      }

      // Clears visual selection from all day cells
      clearSelectionVisuals() {
        document.querySelectorAll('.day').forEach(cell => {
          cell.classList.remove('selected');
        });
      }

      // Updates the highlight for the current day
      updateCurrentDayHighlight() {
        const previouslyHighlighted = document.querySelector('.day.current-day');
        if (previouslyHighlighted) {
          previouslyHighlighted.classList.remove('current-day');
        }

        const today = new Date();
        if (this.currentDate.getMonth() === today.getMonth() &&
            this.currentDate.getFullYear() === today.getFullYear()) {
          const currentDayCell = document.querySelector(`.calendar-grid .day[data-day="${today.getDate()}"]`);
          if (currentDayCell) {
            currentDayCell.classList.add('current-day');
          }
        }
      }

      // Shows a summary of attendance for the current month
      showMonthSummary() {
        const monthYearKey = `${this.currentDate.getMonth()}-${this.currentDate.getFullYear()}`;
        const data = this.calendars[this.activeCalendar]?.[monthYearKey] || {};
        let present = 0, absent = 0, holiday = 0, halfDay = 0, leave = 0, overtime = 0;

        Object.values(data).forEach(entry => {
          if (entry.status === 'present') present++;
          if (entry.status === 'absent') absent++;
          if (entry.status === 'holiday') holiday++;
          if (entry.status === 'half-day') halfDay++;
          if (entry.status === 'leave') leave++;
          if (entry.overtime) overtime += parseFloat(entry.overtime);
        });

        const daysInMonth = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0).getDate();
        const totalRecordedDays = present + absent + holiday + halfDay + leave;
        const attendanceRate = totalRecordedDays > 0 ? Math.round((present / totalRecordedDays) * 100) : 0;

        alert(` ${this.getFormattedMonthYear()}     :\n\n : ${present} \n  : ${halfDay} \n : ${absent} \n : ${leave} \n : ${holiday} \n : ${overtime.toFixed(1)} \n\n   ( /    ): ${attendanceRate}%`);
      }

      // Toggles the side menu visibility
      toggleMenu() {
        if (this.sideMenu && this.overlayMenu) {
          this.sideMenu.classList.toggle('active');
          this.overlayMenu.classList.toggle('active');
          document.body.style.overflow = this.sideMenu.classList.contains('active') ? 'hidden' : '';
        }
      }

      // Helper function to show a specific screen
      showScreen(screenElement) {
        // Hide all major screens first
        this.appContainer.style.display = 'none';
        this.holidayScreen.classList.remove('active');
        this.birthdayScreen.classList.remove('active');
        this.settingsScreen.classList.remove('active');
        this.profileScreen.classList.remove('active');
        this.calendarActivitiesScreen.classList.remove('active');

        // Then show the requested screen
        screenElement.classList.add('active');

        // Ensure any modals are hidden
        this.hideDayDetails();
        this.hideOvertimeModal();
        document.body.style.overflow = 'hidden'; // Prevent body scroll when a screen is active
      }

      // Helper function to hide a specific screen and show main calendar
      hideScreen(screenElement) {
        screenElement.classList.remove('active');
        this.appContainer.style.display = 'flex'; // Show calendar and action buttons
        document.body.style.overflow = ''; // Restore body scroll
      }

      // Holiday Screen Functions
      holidays2025 = [
        { name: " ", date: " 01, 2025" },
        { name: " ", date: " 14, 2025" },
        { name: " ", date: " 26, 2025" },
        { name: " ", date: " 14, 2025" },
        { name: " ", date: " 16, 2025" },
        { name: "", date: " 17, 2025" },
        { name: " /  ", date: " 09, 2025" },
        { name: " ", date: " 13, 2025" },
        { name: " ", date: " 17, 2025" },
        { name: " ", date: " 23, 2025" },
        { name: " ", date: " 24, 2025" },
        { name: "--", date: " 30, 2025" },
        { name: " ", date: " 10, 2025" },
        { name: "-- ()", date: " 27, 2025" },
        { name: "", date: " 25, 2025" },
        { name: " ", date: " 15, 2025" },
        { name: " ", date: " 19, 2025" },
        { name: "", date: " 26, 2025" },
        { name: " ", date: " 06, 2025" },
        { name: "  ", date: " 29, 2025" },
        { name: " ", date: " 02, 2025" },
        { name: " ", date: " 03, 2025" },
        { name: "", date: " 04, 2025" },
        { name: "", date: " 23, 2025" },
        { name: "", date: " 25, 2025" },
        { name: " ", date: " 26, 2025" },
        { name: " ", date: " 27, 2025" },
        { name: "  ", date: " 15, 2025" },
        { name: "", date: " 25, 2025" }
      ];

      renderHolidays() {
        this.holidaysList.innerHTML = '';
        this.holidays2025.forEach(holiday => {
          const holidayItem = document.createElement('div');
          holidayItem.className = 'holiday-item';
          holidayItem.innerHTML = `
            <span class="holiday-name">${holiday.name}</span>
            <span class="holiday-date">${holiday.date}</span>
          `;
          this.holidaysList.appendChild(holidayItem);
        });
      }

      // Birthday Reminder Functions
      addBirthday() {
        const name = this.birthdayNameInput.value.trim();
        const date = this.birthdayDateInput.value;
        const relation = this.birthdayRelationSelect.value;

        if (!name || !date) {
          alert("       "); // Please enter name and birthday date.
          return;
        }

        const newBirthday = {
          id: Date.now(),
          name: name,
          date: date,
          relation: relation || ' ' // None
        };

        this.birthdays.push(newBirthday);
        this.saveData();
        this.renderBirthdays();

        // Clear form
        this.birthdayNameInput.value = '';
        this.birthdayDateInput.value = '';
        this.birthdayRelationSelect.value = '';
        alert("   !"); // Birthday added successfully!
      }

      renderBirthdays() {
        this.birthdaysListContainer.innerHTML = '';

        if (this.birthdays.length === 0) {
            const noBirthdaysMessage = document.createElement('p');
            noBirthdaysMessage.textContent = "               "; // No birthdays added yet. Use the form above to add.
            noBirthdaysMessage.style.textAlign = 'center';
            noBirthdaysMessage.style.color = '#777';
            noBirthdaysMessage.style.padding = '20px';
            this.birthdaysListContainer.appendChild(noBirthdaysMessage);
            return;
        }

        this.birthdays.sort((a, b) => {
            const dateA = new Date(a.date);
            const dateB = new Date(b.date);
            if (dateA.getMonth() !== dateB.getMonth()) {
                return dateA.getMonth() - dateB.getMonth();
            }
            return dateA.getDate() - dateB.getDate();
        });

        this.birthdays.forEach(bday => {
          const bdayItem = document.createElement('div');
          bdayItem.className = 'birthday-list-item';
          bdayItem.dataset.id = bday.id;

          const formattedDate = new Date(bday.date).toLocaleDateString('hi-IN', {
            year: 'numeric', month: 'long', day: 'numeric'
          });

          bdayItem.innerHTML = `
            <strong>${bday.name}</strong>
            <span><i class="fas fa-gift"></i> Birthday: ${formattedDate}</span>
            <span><i class="fas fa-user-friends"></i> Relation: ${bday.relation}</span>
            <button class="delete-birthday-btn" aria-label="Delete birthday">
                <i class="fas fa-trash-alt"></i>
            </button>
          `;

          const deleteBtn = bdayItem.querySelector('.delete-birthday-btn');
          deleteBtn.addEventListener('click', () => this.deleteBirthday(bday.id));

          this.birthdaysListContainer.appendChild(bdayItem);
        });
      }

      deleteBirthday(idToDelete) {
        if (confirm("       ?")) { // Do you want to delete this birthday?
          this.birthdays = this.birthdays.filter(bday => bday.id !== idToDelete);
          this.saveData();
          this.renderBirthdays();
          alert("   "); // Birthday deleted successfully.
        }
      }

      // Settings Functions
      loadSettings() {
        this.dailyReminderToggle.checked = this.settings.dailyReminder;
      }

      toggleDailyReminder() {
        this.settings.dailyReminder = this.dailyReminderToggle.checked;
        this.saveData();
        alert(` : ${this.settings.dailyReminder ? '' : ''}`); // Daily Reminder: On/Off
      }

      // My Profile Functions
      loadProfile() {
        this.profileNameInput.value = this.userProfile.name;
        this.profileEmailInput.value = this.userProfile.email;
        this.updateProfileInitial();
      }

      updateProfileInitial() {
        const name = this.profileNameInput.value.trim();
        this.profileInitial.textContent = name.charAt(0).toUpperCase() || 'U';
      }

      saveProfile() {
        this.userProfile.name = this.profileNameInput.value.trim();
        this.userProfile.email = this.profileEmailInput.value.trim();
        this.saveData();
        this.updateProfileInitial(); // Update the icon immediately
        alert("   !"); // Profile information saved!
      }

      // Calendar Activities Functions
      updateTopBarTitle() {
        // This method is modified to only show "Attendance Calendar"
        if (this.topBarTitle) {
            this.topBarTitle.textContent = `Attendance Calendar`;
        }
      }

      renderCalendarList() {
        this.calendarsList.innerHTML = '';
        this.activeCalendarNameSpan.textContent = this.activeCalendar;

        const calendarNames = Object.keys(this.calendars);

        if (calendarNames.length === 0) {
            const noCalendarsMessage = document.createElement('p');
            noCalendarsMessage.textContent = "              "; // No calendar found. Use the form above to add a new one.
            noCalendarsMessage.style.textAlign = 'center';
            noCalendarsMessage.style.color = '#777';
            noCalendarsMessage.style.padding = '20px';
            this.calendarsList.appendChild(noCalendarsMessage);
            return;
        }

        calendarNames.forEach(name => {
            const listItem = document.createElement('div');
            listItem.className = 'calendar-list-item';
            if (name === this.activeCalendar) {
                listItem.classList.add('active-calendar');
            }

            listItem.innerHTML = `
                <span class="calendar-name">
                    <i class="fas fa-calendar"></i> ${name}
                </span>
                <div class="calendar-actions">
                    <button class="btn-switch" data-calendar-name="${name}" title="Switch to this calendar">
                        <i class="fas fa-toggle-on"></i>
                    </button>
                    <button class="btn-edit" data-calendar-name="${name}" title="Edit calendar name">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn-delete" data-calendar-name="${name}" title="Delete this calendar">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
            `;

            listItem.querySelector('.btn-switch').addEventListener('click', (e) => {
                const calName = e.currentTarget.dataset.calendarName;
                if (calName !== this.activeCalendar) {
                    this.switchCalendar(calName);
                }
            });
            listItem.querySelector('.btn-edit').addEventListener('click', (e) => {
                const oldName = e.currentTarget.dataset.calendarName;
                this.promptEditCalendar(oldName);
            });
            listItem.querySelector('.btn-delete').addEventListener('click', (e) => {
                const calName = e.currentTarget.dataset.calendarName;
                this.deleteCalendar(calName);
            });

            this.calendarsList.appendChild(listItem);
        });
      }

      addCalendar() {
        const newName = this.newCalendarNameInput.value.trim();

        if (!newName) {
            alert("        "); // Please enter a name for the new calendar.
            return;
        }
        if (this.calendars[newName]) {
            alert(`"${newName}"            `); // A calendar with the name "${newName}" already exists. Please choose a different name.
            return;
        }



    if (this.calendars[newName]) {
            alert(`"${newName}"            `); // A calendar with the name "${newName}" already exists. Please choose a different name.
            return;
        }

        this.calendars[newName] = {}; // Create an empty calendar object
        this.activeCalendar = newName; // Set it as active
        this.saveData();

        this.newCalendarNameInput.value = ''; // Clear input
        alert(` "${newName}"       `); // Calendar "${newName}" successfully added and activated.
        this.renderCalendarList(); // Re-render the list
        this.renderCalendar(); // Re-render the main calendar with new active calendar
        this.updateTopBarTitle(); // Update the title bar
      }

      switchCalendar(nameToSwitch) {
        if (!this.calendars[nameToSwitch]) {
            alert("  "); // Calendar not found.
            return;
        }
        if (this.activeCalendar === nameToSwitch) {
            alert("      "); // This calendar is already active.
            return;
        }

        this.activeCalendar = nameToSwitch;
        this.saveData();
        alert(` "${nameToSwitch}"   `); // Calendar "${nameToSwitch}" is now active.
        this.renderCalendarList(); // Update the list display
        this.renderCalendar(); // Re-render the main calendar view
        this.updateTopBarTitle(); // Update the title bar
        this.hideScreen(this.calendarActivitiesScreen); // Go back to calendar view
      }

      promptEditCalendar(oldName) {
        const newName = prompt(`"${oldName}"      :`, oldName); // Enter new name for "${oldName}":
        if (newName === null || newName.trim() === '' || newName.trim() === oldName) {
            return; // User cancelled or entered same/empty name
        }
        const trimmedNewName = newName.trim();

        if (this.calendars[trimmedNewName] && trimmedNewName !== oldName) {
            alert(`"${trimmedNewName}"       `); // A calendar with the name "${trimmedNewName}" already exists.
            return;
        }

        // Create a copy of the old calendar's data
        const oldCalendarData = this.calendars[oldName];
        // Delete the old entry
        delete this.calendars[oldName];
        // Add new entry with new name and old data
        this.calendars[trimmedNewName] = oldCalendarData;

        // If the edited calendar was active, update activeCalendar
        if (this.activeCalendar === oldName) {
            this.activeCalendar = trimmedNewName;
        }

        this.saveData();
        alert(`   "${oldName}"   "${trimmedNewName}"   `); // Calendar name changed from "${oldName}" to "${trimmedNewName}".
        this.renderCalendarList();
        this.updateTopBarTitle(); // Update the top bar title in case active calendar was renamed
      }

      deleteCalendar(nameToDelete) {
        if (Object.keys(this.calendars).length <= 1) {
            alert("             "); // You cannot delete the only calendar. At least one calendar is required.
            return;
        }
        if (nameToDelete === this.activeCalendar) {
            alert("                "); // You cannot delete the active calendar. Please switch to another calendar before deleting.
            return;
        }

        if (confirm(`    "${nameToDelete}"        ?       `)) { // Are you sure you want to delete calendar "${nameToDelete}" and all its data? This action cannot be undone.
            delete this.calendars[nameToDelete];
            this.saveData();
            alert(` "${nameToDelete}"   `); // Calendar "${nameToDelete}" successfully deleted.
            this.renderCalendarList();
        }
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      const calendar = new AttendanceCalendar();

      // Demo data generation
      setTimeout(() => {
        const today = new Date().getDate();

        // Add some initial demo data if localStorage is empty for the 'Default' calendar
        // Ensure 'Default' exists before trying to add data
        if (!calendar.calendars['Default'] || Object.keys(calendar.calendars['Default']).length === 0) {
            calendar.activeCalendar = "Default"; // Temporarily ensure Default is active for demo data population
            calendar.setDayData(15, {status: 'present', note: '   10 '}); // Team meeting at 10 AM
            calendar.setDayData(20, {status: 'holiday', note: ' '}); // National holiday
            calendar.setDayData(25, {status: 'absent', overtime: 2.5});
            calendar.setDayData(10, {status: 'present', overtime: 1.0, note: 'Client meeting till late'});
            calendar.setDayData(5, {status: 'holiday', overtime: 3.0});
            calendar.setDayData(3, {status: 'half-day', note: '   '}); // Half day leave
            calendar.setDayData(7, {status: 'leave', note: '  '}); // On personal leave
        }

        // Add some initial demo birthdays if localStorage is empty
        if (!localStorage.getItem("birthdays") || JSON.parse(localStorage.getItem("birthdays")).length === 0) {
            calendar.birthdays.push(
                { id: Date.now() + 1, name: "", date: "2025-07-20", relation: "Family" },
                { id: Date.now() + 2, name: "", date: "2025-01-15", relation: "Friend" },
                { id: Date.now() + 3, name: "", date: "2025-11-05", relation: "Colleague" }
            );
            calendar.saveData();
        }

        // Add demo profile data if localStorage is empty
        if (!localStorage.getItem("userProfile") || !JSON.parse(localStorage.getItem("userProfile")).name) {
            calendar.userProfile.name = ""; // User
            calendar.userProfile.email = "user@example.com";
            calendar.saveData();
        }

        // Set 'Default' as active calendar if somehow it's not set
        if (!calendar.activeCalendar || !calendar.calendars[calendar.activeCalendar]) {
            calendar.activeCalendar = "Default";
            calendar.saveData();
        }

        const todayCell = document.querySelector(`.calendar-grid .day[data-day="${today}"]`);
        if (todayCell) {
          calendar.toggleDaySelection(todayCell, today);
        } else {
            console.warn("Could not find today's cell to apply demo data.");
            calendar.renderCalendar();
        }
        calendar.updateProfileInitial(); // Ensure profile initial is set on load
        calendar.updateTopBarTitle(); // Ensure top bar title is set on initial load
      }, 500);
    });
  </script>
</body>
</html>

